<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sounds Sus 🎭 Ultra Alpha - Lobby</title>
<script src="/socket.io/socket.io.js"></script>
<style>
body{background:#121212;color:#fff;font-family:Arial;text-align:center;}
input,button,select{margin:6px;padding:8px;border-radius:8px;border:none;}
button{background:#1e88e5;color:white;cursor:pointer;font-weight:bold;transition:all 0.2s;}
button:hover{background:#1565c0;transform:scale(1.05);}
#lobby{margin-top:20px;}
</style>
</head>
<body>

<h1>Sounds Sus 🎭 Ultra Alpha</h1>

<div id="joinSection">
  <input id="nameInput" placeholder="Enter your name">
  <input id="roomInput" placeholder="Room code (leave blank to create)">
  <button id="joinBtn">Join / Create Room</button>
</div>

<div id="lobby" style="display:none;">
  <h3>Room Code: <span id="roomCodeDisplay"></span></h3>
  <h4>Players:</h4>
  <ul id="playerList"></ul>

  <h4>Theme:</h4>
  <select id="themeSelect">
    <option value="classic">🎴 Classic</option>
    <option value="spooky">🎃 Spooky</option>
    <option value="retro">🕹️ Retro</option>
    <option value="neon">💡 Neon</option>
  </select>
  <button id="themeBtn">Set Theme</button>

  <br><br>
  <button id="startBtn">Start Game</button>
</div>

<script>
const socket = io();
let playerName = "";
let roomId = "";

const savedName = localStorage.getItem("playerName");
if(savedName) document.getElementById("nameInput").value = savedName;

document.getElementById("joinBtn").onclick = () => {
  playerName = document.getElementById("nameInput").value.trim() || "Player-"+Math.floor(Math.random()*1000);
  roomId = document.getElementById("roomInput").value.trim().toUpperCase() || null;
  localStorage.setItem("playerName", playerName);
  socket.emit("joinGame",{roomId, playerName});
};

socket.on("roomJoined", r => {
  roomId = r;
  document.getElementById("joinSection").style.display="none";
  document.getElementById("lobby").style.display="block";
  document.getElementById("roomCodeDisplay").innerText = roomId;
});

socket.on("updateGame", data => {
  const list = document.getElementById("playerList");
  list.innerHTML="";
  (data.players||[]).forEach(p=>{
    const li=document.createElement("li"); li.innerText=p; list.appendChild(li);
  });
  document.getElementById("themeSelect").value = data.theme || "classic";
});

document.getElementById("themeBtn").onclick = () => {
  const theme = document.getElementById("themeSelect").value;
  socket.emit("setTheme", theme);
};

document.getElementById("startBtn").onclick = () => {
  socket.emit("startGame",{roomId});
};

</script>
</body>
</html>
